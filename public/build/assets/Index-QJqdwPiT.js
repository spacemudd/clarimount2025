import{d as z,u as D,p as k,c as F,C as j,i as V,o as d,w as o,f as t,b as a,e as s,t as n,h as p,a as _,F as T,r as $,l as A,n as B}from"./app-DIDSfSZF.js";import{_ as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-BCIcK_gG.js";import{_ as x}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BuG49Fjo.js";import{_ as f,a as h}from"./CardContent.vue_vue_type_script_setup_true_lang-DgJKSpxy.js";import{_ as S,a as N}from"./CardTitle.vue_vue_type_script_setup_true_lang-CiU-Ms3R.js";import{_ as J}from"./Badge.vue_vue_type_script_setup_true_lang-BJW2rQhJ.js";import{_ as m}from"./Icon.vue_vue_type_script_setup_true_lang-BWgAxnfc.js";import"./useForwardExpose-rWx5Wlte.js";import"./RovingFocusGroup-DasZ1GaQ.js";import"./building-DfDbSVKB.js";import"./users-UXLO6h05.js";import"./activity-fxp6xkIz.js";import"./arrow-left-CqZxBiFW.js";import"./calendar-Ct4wjpkF.js";import"./check-DoKDPK-M.js";import"./chevron-down-CVKzemRO.js";import"./search-Ce0Gs4fl.js";import"./eye-BMtPuZMg.js";import"./user-YiNlJlvt.js";import"./loader-circle-CjFTefQs.js";import"./sun-BWc7wIhu.js";import"./play-BLJLDOBU.js";import"./plus-D2aM2v7_.js";import"./square-pen-BxgRickh.js";import"./trash-2-CuI05wsn.js";import"./triangle-alert-CfiiQjKB.js";const L={class:"flex items-center justify-between"},H={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},M={class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},U={class:"flex items-center gap-4"},G={class:"py-6"},Q={class:"mx-auto max-w-7xl px-6 lg:px-8"},W={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Y={class:"flex items-center"},Z={class:"flex-shrink-0"},tt={class:"flex h-8 w-8 items-center justify-center rounded-md bg-yellow-100 text-yellow-600"},et={class:"ml-4"},st={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},at={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},nt={class:"flex items-center"},ot={class:"flex-shrink-0"},it={class:"flex h-8 w-8 items-center justify-center rounded-md bg-blue-100 text-blue-600"},rt={class:"ml-4"},lt={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},ct={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},dt={class:"flex items-center"},_t={class:"flex-shrink-0"},mt={class:"flex h-8 w-8 items-center justify-center rounded-md bg-green-100 text-green-600"},ut={class:"ml-4"},pt={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},ft={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},ht={class:"flex items-center"},yt={class:"flex-shrink-0"},gt={class:"flex h-8 w-8 items-center justify-center rounded-md bg-red-100 text-red-600"},xt={class:"ml-4"},vt={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},kt={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},bt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},wt={key:0,class:"text-center py-8"},Ct={class:"text-gray-500"},Pt={key:1,class:"space-y-4"},Tt={class:"flex items-center justify-between"},$t={class:"flex-1"},St={class:"flex items-center gap-2"},Nt={class:"text-sm font-medium"},Jt={class:"mt-2"},Ft={class:"font-semibold"},At={class:"text-sm text-gray-600 dark:text-gray-400"},Ot={class:"text-xs text-gray-500 dark:text-gray-500"},Et={key:0,class:"text-xs text-blue-600 dark:text-blue-400 mt-1"},Rt={class:"flex gap-2"},Xt={key:0,class:"text-center py-8"},qt={class:"text-gray-500"},It={key:1,class:"space-y-4"},zt={class:"flex items-center justify-between"},Dt={class:"flex-1"},jt={class:"flex items-center gap-2"},Vt={class:"text-sm font-medium"},Bt={class:"mt-2"},Kt={class:"font-semibold"},Lt={class:"text-sm text-gray-600 dark:text-gray-400"},Ht={class:"flex items-center gap-2 mt-1"},Mt={class:"text-xs text-blue-600"},Ut={key:0,class:"text-xs text-blue-600 dark:text-blue-400 mt-1"},Gt={class:"flex gap-2"},Qt={class:"mt-6"},Wt={key:0,class:"text-center py-4"},Yt={class:"text-gray-500"},Zt={key:1,class:"space-y-2"},te={class:"flex items-center gap-3"},ee={class:"font-medium"},se={class:"text-sm text-gray-500"},Je=z({__name:"Index",setup(ae){const{t:l}=D(),u=k([]),b=k([]),y=k({pending:0,processing:0,completed_today:0,failed_today:0}),w=k(!1),C=F(()=>u.value.filter(i=>i.status==="pending").sort((i,r)=>{const e={urgent:4,high:3,normal:2,low:1},c=e[i.priority]||0,v=e[r.priority]||0;return c!==v?v-c:new Date(i.created_at).getTime()-new Date(r.created_at).getTime()})),P=F(()=>u.value.filter(i=>i.status==="processing")),O=i=>{switch(i){case"urgent":return"destructive";case"high":return"secondary";case"normal":return"outline";case"low":return"secondary";default:return"outline"}},E=i=>new Date(i).toLocaleTimeString(),g=async()=>{w.value=!0;try{const[i,r,e]=await Promise.all([fetch("/api/print-jobs/pending"),fetch("/api/print-jobs/history?limit=10"),fetch("/api/print-jobs/statistics")]);i.ok&&(u.value=await i.json()),r.ok&&(b.value=await r.json()),e.ok&&(y.value=await e.json())}catch(i){console.error("Failed to refresh jobs:",i)}finally{w.value=!1}},R=async i=>{var r;try{if((await fetch(`/api/print-jobs/${i.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({status:"processing",print_station_id:"MANUAL_STATION_"+Date.now()})})).ok){const c=u.value.findIndex(v=>v.id===i.id);c!==-1&&(u.value[c].status="processing"),alert(`Print job ${i.job_id} is now processing. Please send the label to your printer.`)}}catch(e){console.error("Failed to process print job:",e)}},X=async i=>{var r;try{(await fetch(`/api/print-jobs/${i.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({status:"completed"})})).ok&&(u.value=u.value.filter(c=>c.id!==i.id),y.value.completed_today++,g())}catch(e){console.error("Failed to complete print job:",e)}},q=async i=>{var r;try{(await fetch(`/api/print-jobs/${i.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({status:"failed",error_message:"Print job failed"})})).ok&&(u.value=u.value.filter(c=>c.id!==i.id),y.value.failed_today++,g())}catch(e){console.error("Failed to fail print job:",e)}},I=async i=>{var r;try{(await fetch(`/api/print-jobs/${i.id}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""}})).ok&&(u.value=u.value.filter(c=>c.id!==i.id))}catch(e){console.error("Failed to cancel print job:",e)}};return j(()=>{g(),setInterval(g,1e4)}),(i,r)=>(d(),V(K,null,{header:o(()=>[t("div",L,[t("div",null,[t("h2",H,n(s(l)("print_station.title")),1),t("p",M,n(s(l)("print_station.description")),1)]),t("div",U,[a(s(x),{onClick:g,disabled:w.value},{default:o(()=>[a(m,{name:"RefreshCw",class:"mr-2 h-4 w-4"}),p(" "+n(s(l)("print_station.refresh")),1)]),_:1},8,["disabled"])])])]),default:o(()=>[t("div",G,[t("div",Q,[t("div",W,[a(s(f),null,{default:o(()=>[a(s(h),{class:"p-6"},{default:o(()=>[t("div",Y,[t("div",Z,[t("div",tt,[a(m,{name:"Clock",class:"h-5 w-5"})])]),t("div",et,[t("dt",st,n(s(l)("print_station.pending_jobs")),1),t("dd",at,n(C.value.length),1)])])]),_:1})]),_:1}),a(s(f),null,{default:o(()=>[a(s(h),{class:"p-6"},{default:o(()=>[t("div",nt,[t("div",ot,[t("div",it,[a(m,{name:"Printer",class:"h-5 w-5"})])]),t("div",rt,[t("dt",lt,n(s(l)("print_station.processing_jobs")),1),t("dd",ct,n(P.value.length),1)])])]),_:1})]),_:1}),a(s(f),null,{default:o(()=>[a(s(h),{class:"p-6"},{default:o(()=>[t("div",dt,[t("div",_t,[t("div",mt,[a(m,{name:"CheckCircle",class:"h-5 w-5"})])]),t("div",ut,[t("dt",pt,n(s(l)("print_station.completed_today")),1),t("dd",ft,n(y.value.completed_today||0),1)])])]),_:1})]),_:1}),a(s(f),null,{default:o(()=>[a(s(h),{class:"p-6"},{default:o(()=>[t("div",ht,[t("div",yt,[t("div",gt,[a(m,{name:"XCircle",class:"h-5 w-5"})])]),t("div",xt,[t("dt",vt,n(s(l)("print_station.failed_today")),1),t("dd",kt,n(y.value.failed_today||0),1)])])]),_:1})]),_:1})]),t("div",bt,[a(s(f),null,{default:o(()=>[a(s(S),null,{default:o(()=>[a(s(N),{class:"flex items-center gap-2"},{default:o(()=>[a(m,{name:"Clock",class:"h-5 w-5 text-yellow-600"}),p(" "+n(s(l)("print_station.pending_queue")),1)]),_:1})]),_:1}),a(s(h),null,{default:o(()=>[C.value.length===0?(d(),_("div",wt,[a(m,{name:"Inbox",class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),t("p",Ct,n(s(l)("print_station.no_pending_jobs")),1)])):(d(),_("div",Pt,[(d(!0),_(T,null,$(C.value,e=>(d(),_("div",{key:e.id,class:"border rounded-lg p-4 bg-yellow-50 dark:bg-yellow-900/10 border-yellow-200 dark:border-yellow-800"},[t("div",Tt,[t("div",$t,[t("div",St,[a(s(J),{variant:O(e.priority)},{default:o(()=>[p(n(e.priority),1)]),_:2},1032,["variant"]),t("span",Nt,n(e.job_id),1)]),t("div",Jt,[t("p",Ft,n(e.asset.asset_tag),1),t("p",At,n(e.asset.model_name)+" - "+n(e.company.name),1),t("p",Ot,n(s(l)("print_station.requested_by"))+" "+n(e.user.name),1),e.comment?(d(),_("p",Et," ğŸ’¬ "+n(e.comment),1)):A("",!0)])]),t("div",Rt,[a(s(x),{size:"sm",onClick:c=>R(e)},{default:o(()=>[a(m,{name:"Play",class:"h-4 w-4"})]),_:2},1032,["onClick"]),a(s(x),{size:"sm",variant:"outline",onClick:c=>I(e)},{default:o(()=>[a(m,{name:"X",class:"h-4 w-4"})]),_:2},1032,["onClick"])])])]))),128))]))]),_:1})]),_:1}),a(s(f),null,{default:o(()=>[a(s(S),null,{default:o(()=>[a(s(N),{class:"flex items-center gap-2"},{default:o(()=>[a(m,{name:"Printer",class:"h-5 w-5 text-blue-600"}),p(" "+n(s(l)("print_station.processing_queue")),1)]),_:1})]),_:1}),a(s(h),null,{default:o(()=>[P.value.length===0?(d(),_("div",Xt,[a(m,{name:"Printer",class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),t("p",qt,n(s(l)("print_station.no_processing_jobs")),1)])):(d(),_("div",It,[(d(!0),_(T,null,$(P.value,e=>(d(),_("div",{key:e.id,class:"border rounded-lg p-4 bg-blue-50 dark:bg-blue-900/10 border-blue-200 dark:border-blue-800"},[t("div",zt,[t("div",Dt,[t("div",jt,[a(s(J),{variant:"secondary"},{default:o(()=>[p(n(e.priority),1)]),_:2},1024),t("span",Vt,n(e.job_id),1)]),t("div",Bt,[t("p",Kt,n(e.asset.asset_tag),1),t("p",Lt,n(e.asset.model_name)+" - "+n(e.company.name),1),t("div",Ht,[r[0]||(r[0]=t("div",{class:"animate-spin h-3 w-3 border-2 border-blue-600 border-t-transparent rounded-full"},null,-1)),t("span",Mt,n(s(l)("print_station.printing")),1)]),e.comment?(d(),_("p",Ut," ğŸ’¬ "+n(e.comment),1)):A("",!0)])]),t("div",Gt,[a(s(x),{size:"sm",variant:"outline",onClick:c=>X(e)},{default:o(()=>[a(m,{name:"Check",class:"h-4 w-4"})]),_:2},1032,["onClick"]),a(s(x),{size:"sm",variant:"destructive",onClick:c=>q(e)},{default:o(()=>[a(m,{name:"X",class:"h-4 w-4"})]),_:2},1032,["onClick"])])])]))),128))]))]),_:1})]),_:1})]),t("div",Qt,[a(s(f),null,{default:o(()=>[a(s(S),null,{default:o(()=>[a(s(N),null,{default:o(()=>[p(n(s(l)("print_station.recent_activity")),1)]),_:1})]),_:1}),a(s(h),null,{default:o(()=>[b.value.length===0?(d(),_("div",Wt,[t("p",Yt,n(s(l)("print_station.no_recent_activity")),1)])):(d(),_("div",Zt,[(d(!0),_(T,null,$(b.value,e=>(d(),_("div",{key:e.id,class:"flex items-center justify-between p-2 rounded border"},[t("div",te,[a(m,{name:e.status==="completed"?"CheckCircle":"XCircle",class:B([e.status==="completed"?"text-green-600":"text-red-600","h-4 w-4"])},null,8,["name","class"]),t("span",ee,n(e.asset.asset_tag),1),a(s(J),{variant:e.status==="completed"?"default":"destructive",size:"sm"},{default:o(()=>[p(n(e.status),1)]),_:2},1032,["variant"])]),t("span",se,n(E(e.completed_at||e.updated_at)),1)]))),128))]))]),_:1})]),_:1})])])])]),_:1}))}});export{Je as default};
