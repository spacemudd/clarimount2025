import{q as g,E as k,J as C,a as l,o as i,f as t,m as a,g as y,t as o,F as M,r as D,n as v,y as N}from"./app-CxR3Rgxi.js";const T={class:"min-h-screen bg-gray-50"},A={class:"bg-white shadow"},S={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},j={class:"py-6"},H={class:"flex items-center justify-between"},L={class:"flex items-center space-x-4"},z=["disabled"],O={class:"text-sm text-gray-500"},E={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},V={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},B={class:"bg-white overflow-hidden shadow rounded-lg"},I={class:"p-5"},K={class:"flex items-center"},R={class:"ml-5 w-0 flex-1"},$={class:"text-lg font-medium text-gray-900"},F={class:"bg-white overflow-hidden shadow rounded-lg"},Z={class:"p-5"},q={class:"flex items-center"},J={class:"ml-5 w-0 flex-1"},P={class:"text-lg font-medium text-gray-900"},U={class:"bg-white overflow-hidden shadow rounded-lg"},X={class:"p-5"},Y={class:"flex items-center"},G={class:"ml-5 w-0 flex-1"},Q={class:"text-lg font-medium text-gray-900"},W={class:"bg-white overflow-hidden shadow rounded-lg"},tt={class:"p-5"},et={class:"flex items-center"},st={class:"ml-5 w-0 flex-1"},ot={class:"text-lg font-medium text-gray-900"},nt={class:"bg-white shadow overflow-hidden sm:rounded-md"},lt={key:0,class:"p-8 text-center"},it={key:1,class:"p-8 text-center"},dt={key:2,class:"divide-y divide-gray-200"},rt={class:"px-4 py-4 sm:px-6"},at={class:"flex items-center justify-between"},ct={class:"flex items-center"},mt={class:"flex-shrink-0"},ut={class:"ml-4"},xt={class:"flex items-center"},gt={class:"text-lg font-medium text-gray-900"},vt={class:"mt-1"},ft={class:"text-sm text-gray-500"},ht={key:0,class:"ml-2"},yt={key:1,class:"ml-2"},_t={class:"flex items-center space-x-4"},bt={class:"text-right"},pt={class:"text-sm text-gray-900"},wt={class:"text-sm text-gray-500"},kt={class:"flex space-x-2"},Ct=["onClick"],Mt=["onClick"],Dt=["onClick"],Nt={key:0,class:"mt-2 p-3 bg-red-50 border border-red-200 rounded-md"},Tt={class:"flex"},At={class:"ml-3"},St={class:"mt-1 text-sm text-red-700"},jt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Ht={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Lt={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"},zt={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Ot={class:"flex items-center justify-between mb-4"},Et={class:"text-lg font-medium text-gray-900"},Vt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Bt={class:"space-y-2"},It={class:"text-sm text-gray-900"},Kt={class:"text-sm text-gray-900"},Rt={class:"text-sm text-gray-900"},$t={class:"text-sm text-gray-900"},Ft={class:"text-sm text-gray-900"},Zt={class:"text-sm text-gray-900"},qt={class:"space-y-2"},Jt={class:"text-sm"},Pt={class:"text-sm text-gray-900"},Ut={class:"text-sm text-gray-900"},Xt={class:"text-sm text-gray-900"},Yt={class:"text-sm text-gray-900"},Gt={key:0,class:"mt-6"},Qt={class:"bg-gray-100 p-3 rounded-md text-xs overflow-auto max-h-40"},te={__name:"Index",props:{devices:Array,stats:Object},setup(r){const c=g(!1),m=g(null),n=g(null);let x=null;const u=async()=>{c.value=!0;try{await N.reload({only:["devices","stats"]}),m.value=new Date}finally{c.value=!1}},_=async d=>{try{const s=await(await fetch(`/zkteko-debug/devices/${d}`)).json();n.value=s.device}catch(e){console.error("Error fetching device details:",e)}},f=()=>{n.value=null},b=async d=>{if(confirm("Are you sure you want to mark this device as offline?"))try{(await fetch(`/zkteko-debug/devices/${d}/mark-offline`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({reason:"Manually marked offline"})})).ok&&await u()}catch(e){console.error("Error marking device offline:",e)}},p=async d=>{try{(await fetch(`/zkteko-debug/devices/${d}/clear-error`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).ok&&await u()}catch(e){console.error("Error clearing device error:",e)}},w=d=>new Date(d).toLocaleString();return k(()=>{m.value=new Date,x=setInterval(()=>{u()},3e4)}),C(()=>{x&&clearInterval(x)}),(d,e)=>(i(),l("div",T,[t("div",A,[t("div",S,[t("div",j,[t("div",H,[e[1]||(e[1]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"ZKTeko Debug Dashboard"),t("p",{class:"mt-2 text-sm text-gray-600"}," Monitor ZKTeko fingerprint devices and their heartbeats ")],-1)),t("div",L,[t("button",{onClick:u,disabled:c.value,class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50"},[e[0]||(e[0]=t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),y(" "+o(c.value?"Refreshing...":"Refresh"),1)],8,z),t("div",O," Last updated: "+o(m.value?w(m.value):"Never"),1)])])])])]),t("div",E,[t("div",V,[t("div",B,[t("div",I,[t("div",K,[e[3]||(e[3]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-6 w-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})])],-1)),t("div",R,[t("dl",null,[e[2]||(e[2]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Devices",-1)),t("dd",$,o(r.stats.total_devices),1)])])])])]),t("div",F,[t("div",Z,[t("div",q,[e[5]||(e[5]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-3 h-3 bg-green-400 rounded-full"})],-1)),t("div",J,[t("dl",null,[e[4]||(e[4]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Online Devices",-1)),t("dd",P,o(r.stats.online_devices),1)])])])])]),t("div",U,[t("div",X,[t("div",Y,[e[7]||(e[7]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-3 h-3 bg-red-400 rounded-full"})],-1)),t("div",G,[t("dl",null,[e[6]||(e[6]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Offline Devices",-1)),t("dd",Q,o(r.stats.offline_devices),1)])])])])]),t("div",W,[t("div",tt,[t("div",et,[e[9]||(e[9]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-6 w-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1)),t("div",st,[t("dl",null,[e[8]||(e[8]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Recent Heartbeats",-1)),t("dd",ot,o(r.stats.devices_with_recent_heartbeats),1)])])])])])]),t("div",nt,[e[14]||(e[14]=t("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[t("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"ZKTeko Devices"),t("p",{class:"mt-1 max-w-2xl text-sm text-gray-500"}," List of all ZKTeko fingerprint devices and their current status ")],-1)),c.value&&r.devices.length===0?(i(),l("div",lt,e[10]||(e[10]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading devices...",-1)]))):r.devices.length===0?(i(),l("div",it,e[11]||(e[11]=[t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})],-1),t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No devices found",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"No ZKTeko devices have been detected yet.",-1)]))):(i(),l("ul",dt,[(i(!0),l(M,null,D(r.devices,s=>(i(),l("li",{key:s.id,class:"hover:bg-gray-50"},[t("div",rt,[t("div",at,[t("div",ct,[t("div",mt,[t("div",{class:v(["w-3 h-3 rounded-full",{"bg-green-400":s.is_online&&!s.is_considered_offline,"bg-yellow-400":s.is_online&&s.is_considered_offline,"bg-red-400":!s.is_online}])},null,2)]),t("div",ut,[t("div",xt,[t("h4",gt,o(s.display_name),1),t("span",{class:v(["ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":s.status==="online","bg-red-100 text-red-800":s.status==="offline","bg-yellow-100 text-yellow-800":s.status==="maintenance","bg-gray-100 text-gray-800":s.status==="unknown"}])},o(s.status),3)]),t("div",vt,[t("p",ft,[y(" S/N: "+o(s.serial_number)+" ",1),s.model?(i(),l("span",ht,"• "+o(s.model),1)):a("",!0),s.ip_address?(i(),l("span",yt,"• "+o(s.ip_address),1)):a("",!0)])])])]),t("div",_t,[t("div",bt,[t("div",pt,o(s.total_heartbeats)+" heartbeats ",1),t("div",wt," Last: "+o(s.time_since_last_heartbeat),1)]),t("div",kt,[t("button",{onClick:h=>_(s.id),class:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," View Details ",8,Ct),s.is_online?(i(),l("button",{key:0,onClick:h=>b(s.id),class:"inline-flex items-center px-3 py-1 border border-red-300 rounded-md text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}," Mark Offline ",8,Mt)):a("",!0),s.last_error?(i(),l("button",{key:1,onClick:h=>p(s.id),class:"inline-flex items-center px-3 py-1 border border-yellow-300 rounded-md text-sm font-medium text-yellow-700 bg-white hover:bg-yellow-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500"}," Clear Error ",8,Dt)):a("",!0)])])]),s.last_error?(i(),l("div",Nt,[t("div",Tt,[e[13]||(e[13]=t("svg",{class:"h-5 w-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("div",At,[e[12]||(e[12]=t("h3",{class:"text-sm font-medium text-red-800"},"Error",-1)),t("div",St,o(s.last_error),1)])])])):a("",!0)])]))),128))]))])]),n.value?(i(),l("div",jt,[t("div",Ht,[t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:f}),t("div",Lt,[t("div",zt,[t("div",Ot,[t("h3",Et," Device Details: "+o(n.value.serial_number),1),t("button",{onClick:f,class:"text-gray-400 hover:text-gray-600"},e[15]||(e[15]=[t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",Vt,[t("div",null,[e[22]||(e[22]=t("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"Device Information",-1)),t("dl",Bt,[t("div",null,[e[16]||(e[16]=t("dt",{class:"text-sm text-gray-500"},"Serial Number",-1)),t("dd",It,o(n.value.serial_number),1)]),t("div",null,[e[17]||(e[17]=t("dt",{class:"text-sm text-gray-500"},"Device Name",-1)),t("dd",Kt,o(n.value.device_name||"N/A"),1)]),t("div",null,[e[18]||(e[18]=t("dt",{class:"text-sm text-gray-500"},"Model",-1)),t("dd",Rt,o(n.value.model||"N/A"),1)]),t("div",null,[e[19]||(e[19]=t("dt",{class:"text-sm text-gray-500"},"Firmware Version",-1)),t("dd",$t,o(n.value.firmware_version||"N/A"),1)]),t("div",null,[e[20]||(e[20]=t("dt",{class:"text-sm text-gray-500"},"IP Address",-1)),t("dd",Ft,o(n.value.ip_address||"N/A"),1)]),t("div",null,[e[21]||(e[21]=t("dt",{class:"text-sm text-gray-500"},"MAC Address",-1)),t("dd",Zt,o(n.value.mac_address||"N/A"),1)])])]),t("div",null,[e[28]||(e[28]=t("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"Status Information",-1)),t("dl",qt,[t("div",null,[e[23]||(e[23]=t("dt",{class:"text-sm text-gray-500"},"Status",-1)),t("dd",Jt,[t("span",{class:v(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":n.value.status==="online","bg-red-100 text-red-800":n.value.status==="offline","bg-yellow-100 text-yellow-800":n.value.status==="maintenance","bg-gray-100 text-gray-800":n.value.status==="unknown"}])},o(n.value.status),3)])]),t("div",null,[e[24]||(e[24]=t("dt",{class:"text-sm text-gray-500"},"Online",-1)),t("dd",Pt,o(n.value.is_online?"Yes":"No"),1)]),t("div",null,[e[25]||(e[25]=t("dt",{class:"text-sm text-gray-500"},"Last Heartbeat",-1)),t("dd",Ut,o(n.value.time_since_last_heartbeat),1)]),t("div",null,[e[26]||(e[26]=t("dt",{class:"text-sm text-gray-500"},"Total Heartbeats",-1)),t("dd",Xt,o(n.value.total_heartbeats),1)]),t("div",null,[e[27]||(e[27]=t("dt",{class:"text-sm text-gray-500"},"Total Attendance Records",-1)),t("dd",Yt,o(n.value.total_attendance_records),1)])])])]),n.value.device_info?(i(),l("div",Gt,[e[29]||(e[29]=t("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"Raw Device Data",-1)),t("pre",Qt,o(JSON.stringify(n.value.device_info,null,2)),1)])):a("",!0)])])])])):a("",!0)]))}};export{te as default};
