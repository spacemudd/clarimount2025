import{d as B,u as K,p as h,c as A,C as M,i as j,o as l,w as r,f as e,b as s,e as a,t as o,h as p,a as c,F as C,r as P,l as O,n as H,m as U,v as G}from"./app-D3LdiifG.js";import{_ as Q}from"./AppLayout.vue_vue_type_script_setup_true_lang-Cn4d7ll3.js";import{_ as x}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-vV8PW8Ut.js";import{_ as g,a as y}from"./CardContent.vue_vue_type_script_setup_true_lang-DmABaePk.js";import{_ as F,a as Z}from"./CardTitle.vue_vue_type_script_setup_true_lang-COAVk3SO.js";import{_ as L}from"./Badge.vue_vue_type_script_setup_true_lang-w5PyHZM5.js";import{_ as d}from"./Icon.vue_vue_type_script_setup_true_lang-DNrj-HSi.js";import"./useForwardExpose-w1gfauGB.js";import"./RovingFocusGroup-CpnF0ycG.js";import"./building-BA77nW2t.js";import"./users-CABRP0Cj.js";import"./activity-B17Zh4Dq.js";import"./arrow-left-CAlQ2p7T.js";import"./calendar-Dk3mYTdz.js";import"./check-CLTzwfe9.js";import"./chevron-down-C63vKOJu.js";import"./search-HiSSpd-m.js";import"./eye-BSTL68Fh.js";import"./user-Zy25AZ2R.js";import"./loader-circle-bn3ZAs3A.js";import"./sun-CBoOZXXy.js";import"./play-BcbHS29B.js";import"./plus-CqsPXapN.js";import"./square-pen-B_AkG4cx.js";import"./trash-2-DDU2_33G.js";import"./triangle-alert-CtwAzkUx.js";const W={class:"flex items-center justify-between"},Y={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},ee={class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},te={class:"flex items-center gap-4"},se={class:"flex items-center gap-2"},ae=["value"],ne={class:"py-6"},oe={class:"mx-auto max-w-7xl px-6 lg:px-8"},ie={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},re={class:"flex items-center"},le={class:"flex-shrink-0"},ce={class:"flex h-8 w-8 items-center justify-center rounded-md bg-yellow-100 text-yellow-600"},de={class:"ml-4"},_e={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},ue={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},me={class:"flex items-center"},pe={class:"flex-shrink-0"},fe={class:"flex h-8 w-8 items-center justify-center rounded-md bg-blue-100 text-blue-600"},he={class:"ml-4"},ge={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},ye={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},xe={class:"flex items-center"},ve={class:"flex-shrink-0"},be={class:"flex h-8 w-8 items-center justify-center rounded-md bg-green-100 text-green-600"},ke={class:"ml-4"},we={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Ce={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},Pe={class:"flex items-center"},Te={class:"flex-shrink-0"},$e={class:"flex h-8 w-8 items-center justify-center rounded-md bg-red-100 text-red-600"},De={class:"ml-4"},Se={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Fe={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},Ze={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Le={key:0,class:"text-center py-8"},Ne={class:"text-gray-500"},Je={key:1,class:"space-y-4"},Ae={class:"flex items-center justify-between"},Oe={class:"flex-1"},ze={class:"flex items-center gap-2"},Re={class:"text-sm font-medium"},Ee={class:"mt-2"},Xe={class:"font-semibold"},qe={class:"text-sm text-gray-600 dark:text-gray-400"},Ie={class:"text-xs text-gray-500 dark:text-gray-500"},Ve={key:0,class:"text-xs text-blue-600 dark:text-blue-400 mt-1"},Be={class:"flex gap-2"},Ke={key:0,class:"text-center py-8"},Me={class:"text-gray-500"},je={key:1,class:"space-y-4"},He={class:"flex items-center justify-between"},Ue={class:"flex-1"},Ge={class:"flex items-center gap-2"},Qe={class:"text-sm font-medium"},We={class:"mt-2"},Ye={class:"font-semibold"},et={class:"text-sm text-gray-600 dark:text-gray-400"},tt={class:"flex items-center gap-2 mt-1"},st={class:"text-xs text-blue-600"},at={key:0,class:"text-xs text-blue-600 dark:text-blue-400 mt-1"},nt={class:"flex gap-2"},ot={class:"mt-6"},it={key:0,class:"text-center py-4"},rt={class:"text-gray-500"},lt={key:1,class:"space-y-2"},ct={class:"flex items-center gap-3"},dt={class:"font-medium"},_t={class:"text-sm text-gray-500"},Et=B({__name:"Index",setup(ut){const{t:_}=K(),m=h([]),T=h([]),v=h({pending:0,processing:0,completed_today:0,failed_today:0}),$=h(!1),k=h(!1),f=h(""),N=h([]),D=A(()=>m.value.filter(n=>n.status==="pending").sort((n,i)=>{const t={urgent:4,high:3,normal:2,low:1},u=t[n.priority]||0,w=t[i.priority]||0;return u!==w?w-u:new Date(n.created_at).getTime()-new Date(i.created_at).getTime()})),S=A(()=>m.value.filter(n=>n.status==="processing")),z=n=>{switch(n){case"urgent":return"destructive";case"high":return"secondary";case"normal":return"outline";case"low":return"secondary";default:return"outline"}},R=n=>new Date(n).toLocaleTimeString(),b=async()=>{$.value=!0;try{const[n,i,t]=await Promise.all([fetch("/api/print-jobs/pending"),fetch("/api/print-jobs/history?limit=10"),fetch("/api/print-jobs/statistics")]);n.ok&&(m.value=await n.json()),i.ok&&(T.value=await i.json()),t.ok&&(v.value=await t.json())}catch(n){console.error("Failed to refresh jobs:",n)}finally{$.value=!1}},E=async n=>{var i;if(!f.value){alert("Please select a printer first");return}try{if((await fetch(`/api/print-jobs/${n.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""},body:JSON.stringify({status:"processing",print_station_id:"MANUAL_STATION_"+Date.now(),printer_name:f.value})})).ok){const u=m.value.findIndex(w=>w.id===n.id);u!==-1&&(m.value[u].status="processing"),await X(n)}}catch(t){console.error("Failed to process print job:",t),alert("Failed to process print job: "+t)}},X=async n=>{try{console.log(`Printing label for asset ${n.asset.asset_tag} on printer ${f.value}`),await new Promise(i=>setTimeout(i,1e3)),console.log(`Successfully printed label for asset ${n.asset.asset_tag}`)}catch(i){throw console.error("Failed to print label:",i),i}},q=async n=>{var i;try{(await fetch(`/api/print-jobs/${n.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""},body:JSON.stringify({status:"completed"})})).ok&&(m.value=m.value.filter(u=>u.id!==n.id),v.value.completed_today++,b())}catch(t){console.error("Failed to complete print job:",t)}},I=async n=>{var i;try{(await fetch(`/api/print-jobs/${n.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""},body:JSON.stringify({status:"failed",error_message:"Print job failed"})})).ok&&(m.value=m.value.filter(u=>u.id!==n.id),v.value.failed_today++,b())}catch(t){console.error("Failed to fail print job:",t)}},V=async n=>{var i;try{(await fetch(`/api/print-jobs/${n.id}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""}})).ok&&(m.value=m.value.filter(u=>u.id!==n.id))}catch(t){console.error("Failed to cancel print job:",t)}},J=async()=>{k.value=!0;try{const n=["ZDesigner ZD220-203dpi ZPL","ZDesigner ZD420-203dpi ZPL","ZDesigner ZD410-203dpi ZPL","Zebra ZD220-203dpi ZPL","Zebra ZD420-203dpi ZPL","Microsoft Print to PDF","Generic / Text Only"];N.value=n,console.log("Loaded printers:",n);const i=n.find(t=>t.toLowerCase().includes("zdesigner"));i&&!f.value&&(f.value=i)}catch(n){console.error("Failed to load printers:",n),alert("Failed to load printers: "+n)}finally{k.value=!1}};return M(()=>{b(),J(),setInterval(b,1e4)}),(n,i)=>(l(),j(Q,null,{header:r(()=>[e("div",W,[e("div",null,[e("h2",Y,o(a(_)("print_station.title")),1),e("p",ee,o(a(_)("print_station.description")),1)]),e("div",te,[e("div",se,[s(d,{name:"Printer",class:"h-4 w-4 text-gray-500"}),U(e("select",{"onUpdate:modelValue":i[0]||(i[0]=t=>f.value=t),class:"text-sm border border-gray-300 dark:border-gray-600 rounded-md px-2 py-1 bg-white dark:bg-gray-800"},[i[1]||(i[1]=e("option",{value:""},"Select Printer",-1)),(l(!0),c(C,null,P(N.value,t=>(l(),c("option",{key:t,value:t},o(t),9,ae))),128))],512),[[G,f.value]]),s(a(x),{size:"sm",variant:"outline",onClick:J,disabled:k.value},{default:r(()=>[s(d,{name:"RefreshCw",class:"h-3 w-3"}),p(" "+o(k.value?"Loading...":"Load Printers"),1)]),_:1},8,["disabled"])]),s(a(x),{onClick:b,disabled:$.value},{default:r(()=>[s(d,{name:"RefreshCw",class:"mr-2 h-4 w-4"}),p(" "+o(a(_)("print_station.refresh")),1)]),_:1},8,["disabled"])])])]),default:r(()=>[e("div",ne,[e("div",oe,[e("div",ie,[s(a(g),null,{default:r(()=>[s(a(y),{class:"p-6"},{default:r(()=>[e("div",re,[e("div",le,[e("div",ce,[s(d,{name:"Clock",class:"h-5 w-5"})])]),e("div",de,[e("dt",_e,o(a(_)("print_station.pending_jobs")),1),e("dd",ue,o(D.value.length),1)])])]),_:1})]),_:1}),s(a(g),null,{default:r(()=>[s(a(y),{class:"p-6"},{default:r(()=>[e("div",me,[e("div",pe,[e("div",fe,[s(d,{name:"Printer",class:"h-5 w-5"})])]),e("div",he,[e("dt",ge,o(a(_)("print_station.processing_jobs")),1),e("dd",ye,o(S.value.length),1)])])]),_:1})]),_:1}),s(a(g),null,{default:r(()=>[s(a(y),{class:"p-6"},{default:r(()=>[e("div",xe,[e("div",ve,[e("div",be,[s(d,{name:"CheckCircle",class:"h-5 w-5"})])]),e("div",ke,[e("dt",we,o(a(_)("print_station.completed_today")),1),e("dd",Ce,o(v.value.completed_today||0),1)])])]),_:1})]),_:1}),s(a(g),null,{default:r(()=>[s(a(y),{class:"p-6"},{default:r(()=>[e("div",Pe,[e("div",Te,[e("div",$e,[s(d,{name:"XCircle",class:"h-5 w-5"})])]),e("div",De,[e("dt",Se,o(a(_)("print_station.failed_today")),1),e("dd",Fe,o(v.value.failed_today||0),1)])])]),_:1})]),_:1})]),e("div",Ze,[s(a(g),null,{default:r(()=>[s(a(F),null,{default:r(()=>[s(a(Z),{class:"flex items-center gap-2"},{default:r(()=>[s(d,{name:"Clock",class:"h-5 w-5 text-yellow-600"}),p(" "+o(a(_)("print_station.pending_queue")),1)]),_:1})]),_:1}),s(a(y),null,{default:r(()=>[D.value.length===0?(l(),c("div",Le,[s(d,{name:"Inbox",class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e("p",Ne,o(a(_)("print_station.no_pending_jobs")),1)])):(l(),c("div",Je,[(l(!0),c(C,null,P(D.value,t=>(l(),c("div",{key:t.id,class:"border rounded-lg p-4 bg-yellow-50 dark:bg-yellow-900/10 border-yellow-200 dark:border-yellow-800"},[e("div",Ae,[e("div",Oe,[e("div",ze,[s(a(L),{variant:z(t.priority)},{default:r(()=>[p(o(t.priority),1)]),_:2},1032,["variant"]),e("span",Re,o(t.job_id),1)]),e("div",Ee,[e("p",Xe,o(t.asset.asset_tag),1),e("p",qe,o(t.asset.model_name)+" - "+o(t.company.name),1),e("p",Ie,o(a(_)("print_station.requested_by"))+" "+o(t.user.name),1),t.comment?(l(),c("p",Ve," ğŸ’¬ "+o(t.comment),1)):O("",!0)])]),e("div",Be,[s(a(x),{size:"sm",onClick:u=>E(t)},{default:r(()=>[s(d,{name:"Play",class:"h-4 w-4"})]),_:2},1032,["onClick"]),s(a(x),{size:"sm",variant:"outline",onClick:u=>V(t)},{default:r(()=>[s(d,{name:"X",class:"h-4 w-4"})]),_:2},1032,["onClick"])])])]))),128))]))]),_:1})]),_:1}),s(a(g),null,{default:r(()=>[s(a(F),null,{default:r(()=>[s(a(Z),{class:"flex items-center gap-2"},{default:r(()=>[s(d,{name:"Printer",class:"h-5 w-5 text-blue-600"}),p(" "+o(a(_)("print_station.processing_queue")),1)]),_:1})]),_:1}),s(a(y),null,{default:r(()=>[S.value.length===0?(l(),c("div",Ke,[s(d,{name:"Printer",class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e("p",Me,o(a(_)("print_station.no_processing_jobs")),1)])):(l(),c("div",je,[(l(!0),c(C,null,P(S.value,t=>(l(),c("div",{key:t.id,class:"border rounded-lg p-4 bg-blue-50 dark:bg-blue-900/10 border-blue-200 dark:border-blue-800"},[e("div",He,[e("div",Ue,[e("div",Ge,[s(a(L),{variant:"secondary"},{default:r(()=>[p(o(t.priority),1)]),_:2},1024),e("span",Qe,o(t.job_id),1)]),e("div",We,[e("p",Ye,o(t.asset.asset_tag),1),e("p",et,o(t.asset.model_name)+" - "+o(t.company.name),1),e("div",tt,[i[2]||(i[2]=e("div",{class:"animate-spin h-3 w-3 border-2 border-blue-600 border-t-transparent rounded-full"},null,-1)),e("span",st,o(a(_)("print_station.printing")),1)]),t.comment?(l(),c("p",at," ğŸ’¬ "+o(t.comment),1)):O("",!0)])]),e("div",nt,[s(a(x),{size:"sm",variant:"outline",onClick:u=>q(t)},{default:r(()=>[s(d,{name:"Check",class:"h-4 w-4"})]),_:2},1032,["onClick"]),s(a(x),{size:"sm",variant:"destructive",onClick:u=>I(t)},{default:r(()=>[s(d,{name:"X",class:"h-4 w-4"})]),_:2},1032,["onClick"])])])]))),128))]))]),_:1})]),_:1})]),e("div",ot,[s(a(g),null,{default:r(()=>[s(a(F),null,{default:r(()=>[s(a(Z),null,{default:r(()=>[p(o(a(_)("print_station.recent_activity")),1)]),_:1})]),_:1}),s(a(y),null,{default:r(()=>[T.value.length===0?(l(),c("div",it,[e("p",rt,o(a(_)("print_station.no_recent_activity")),1)])):(l(),c("div",lt,[(l(!0),c(C,null,P(T.value,t=>(l(),c("div",{key:t.id,class:"flex items-center justify-between p-2 rounded border"},[e("div",ct,[s(d,{name:t.status==="completed"?"CheckCircle":"XCircle",class:H([t.status==="completed"?"text-green-600":"text-red-600","h-4 w-4"])},null,8,["name","class"]),e("span",dt,o(t.asset.asset_tag),1),s(a(L),{variant:t.status==="completed"?"default":"destructive",size:"sm"},{default:r(()=>[p(o(t.status),1)]),_:2},1032,["variant"])]),e("span",_t,o(R(t.completed_at||t.updated_at)),1)]))),128))]))]),_:1})]),_:1})])])])]),_:1}))}});export{Et as default};
